<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>POST XENO — Gallery</title>

  <!-- Fonts (same as index) -->
  <link rel="preload" href="/fonts/redseven.ttf?v=2" as="font" type="font/ttf" crossorigin>
  <link rel="preload" href="/fonts/MakinasJP.woff2" as="font" type="font/woff2" crossorigin>

  <style>
    @font-face {
      font-family: "Red Seven";
      src: url("/fonts/redseven.ttf?v=2") format("truetype");
      font-display: swap;
      font-weight: 400;
      font-style: normal;
    }
    @font-face {
      font-family: "MakinasJP";
      src: url("/fonts/MakinasJP.woff2") format("woff2");
      font-display: swap;
      font-weight: 400;
      font-style: normal;
    }

    :root { --bg:#0a0a0a; --muted:#9aa0a6; --text:#e8eaed; --border:#222; }

    * { box-sizing:border-box; }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
        "Noto Sans JP","Hiragino Kaku Gothic ProN",Meiryo,sans-serif;
    }

    header {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand {
      display: inline-flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
    }

    .brand h1 {
      margin: 0;
      font-size: 36px;
      letter-spacing: .05em;
      font-family: "Red Seven", sans-serif;
    }

    .brand-sub {
      font-family: "MakinasJP","Noto Sans JP","Hiragino Kaku Gothic ProN",Meiryo,sans-serif!important;
      font-size: 19px;
      color: var(--muted);
      line-height: 1;
      letter-spacing: .03em;
    }

    .back-btn {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #ffffff10;
      color: var(--text);
      font-size: 12px;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .back-btn span {
      font-size: 12px;
    }

    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 20px 40px 20px;
    }

    /* Gallery grid — cards without external margins */
    .gallery-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0;
    }

    .gallery-card {
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
    }

    .gallery-carousel {
      position: relative;
      width: 100%;
      overflow: hidden;
      border-radius: 20px;
      border: 1px solid var(--border);
      background: #050505;
    }

    .gallery-image {
      display: block;
      width: 100%;
      height: auto;
    }

    .gallery-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      border: 1px solid var(--border);
      border-radius: 999px;
      width: 32px;
      height: 32px;
      background: #00000088;
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      line-height: 1;
      padding: 0;
    }

    .gallery-arrow.left { left: 8px; }
    .gallery-arrow.right { right: 8px; }

    .gallery-arrow:hover {
      background: #ffffff20;
    }

    /* Image modal (shared) */
    .img-modal {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .img-modal[hidden] {
      display: none;
    }

    .img-modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.75);
      backdrop-filter: blur(2px);
    }

    .img-modal-inner {
      position: relative;
      max-width: min(1100px, 95vw);
      max-height: 90vh;
      z-index: 1;
    }

    .img-modal-inner img {
      display: block;
      width: 100%;
      height: auto;
      max-height: 90vh;
      object-fit: contain;
      border-radius: 16px;
      border: 1px solid var(--border);
      background:#050505;
    }

    .img-modal-close {
      position: absolute;
      top: -14px;
      right: -14px;
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #000000dd;
      color: #fff;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @media (max-width: 768px) {
      header {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      }
      .brand {
        align-items: flex-start;
      }
    }
  </style>

  <style>
    #loading-screen {
      position: fixed;
      inset: 0;
      background: #000;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 1;
      transition: opacity 650ms ease;
    }
    #loading-screen.is-hiding {
      opacity: 0;
      pointer-events: none;
    }

    .loader-text {
      color: #fff;
      font-family: monospace;
      letter-spacing: 0.15em;
      opacity: 0.85;
      animation: loaderPulse 1.25s ease-in-out infinite;
      user-select: none;
    }

    @keyframes loaderPulse {
      0%   { opacity: 0.35; transform: translateY(0); }
      50%  { opacity: 0.95; transform: translateY(-1px); }
      100% { opacity: 0.35; transform: translateY(0); }
    }
  </style>
</head>


<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loader-text" data-ja="読み込み中…" data-en="loading…" data-ru="загрузка…">loading…</div>
  </div>
  <header>
    <div class="brand">
      <h1>POST XENO</h1>
      <div class="brand-sub">ポストゼノ</div>
    </div>

    <a href="/" class="back-btn">
      <span
        data-ja="← ストアに戻る"
        data-en="← Back to Store"
        data-ru="← Назад в магазин">← ストアに戻る</span>
    </a>
  </header>

  <main>
    <section class="gallery-grid" aria-label="Gallery">
      <!-- GALLERY CARD 1: MM01–MM04 carousel -->
      <article class="gallery-card" data-id="mm-look-1">
        <div class="gallery-carousel" data-gallery="mm-look-1">
          <button class="gallery-arrow left" type="button" data-dir="prev">‹</button>
          <img
            src="/images/MM01.jpg"
            alt="POST XENO Look 1"
            class="gallery-image">
          <button class="gallery-arrow right" type="button" data-dir="next">›</button>
        </div>
      </article>

      <!-- GALLERY CARD 2: FM01–FM04 carousel -->
      <article class="gallery-card" data-id="fm-look-1">
        <div class="gallery-carousel" data-gallery="fm-look-1">
          <button class="gallery-arrow left" type="button" data-dir="prev">‹</button>
          <img
            src="/images/FM01.jpg"
            alt="POST XENO Look 2"
            class="gallery-image">
          <button class="gallery-arrow right" type="button" data-dir="next">›</button>
        </div>
      </article>

      <!-- STATIC IMAGES: RL02–RL11 (stacked) -->
      <article class="gallery-card" data-id="rl-02">
        <div class="gallery-carousel">
          <img
            src="/images/RL02.jpg"
            alt="POST XENO RL02"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-03">
        <div class="gallery-carousel">
          <img
            src="/images/RL03.jpg"
            alt="POST XENO RL03"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-04">
        <div class="gallery-carousel">
          <img
            src="/images/RL04.jpg"
            alt="POST XENO RL04"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-05">
        <div class="gallery-carousel">
          <img
            src="/images/RL05.jpg"
            alt="POST XENO RL05"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-06">
        <div class="gallery-carousel">
          <img
            src="/images/RL06.jpg"
            alt="POST XENO RL06"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-07">
        <div class="gallery-carousel">
          <img
            src="/images/RL07.jpg"
            alt="POST XENO RL07"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-08">
        <div class="gallery-carousel">
          <img
            src="/images/RL08.jpg"
            alt="POST XENO RL08"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-09">
        <div class="gallery-carousel">
          <img
            src="/images/RL09.jpg"
            alt="POST XENO RL09"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-10">
        <div class="gallery-carousel">
          <img
            src="/images/RL10.jpg"
            alt="POST XENO RL10"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <article class="gallery-card" data-id="rl-11">
        <div class="gallery-carousel">
          <img
            src="/images/RL11.jpg"
            alt="POST XENO RL11"
            class="gallery-image static-gallery-image">
        </div>
      </article>

      <!-- Future gallery-card blocks can be added here -->
    </section>

    <!-- Shared image modal -->
    <div class="img-modal" id="imageModal" hidden>
      <div class="img-modal-backdrop"></div>
      <div class="img-modal-inner">
        <img id="modalImage" src="" alt="">
        <button type="button" class="img-modal-close">×</button>
      </div>
    </div>
  </main>

  <script>
    // Sync language with index using localStorage 'lang'
    (function() {
      var currentLang = localStorage.getItem('lang') || 'ja';
      document.documentElement.lang = currentLang;

      function applyLang(lang) {
        document.querySelectorAll('[data-ja],[data-en],[data-ru]').forEach(function(el) {
          var ja = el.getAttribute('data-ja');
          var en = el.getAttribute('data-en');
          var ru = el.getAttribute('data-ru');
          var next = null;
          if (lang === 'ru') next = ru || en || ja;
          else if (lang === 'en') next = en || ja || ru;
          else next = ja || en || ru;
          if (next !== null) el.textContent = next;
        });
      }

      applyLang(currentLang);
    })();
      // Loading screen (5 seconds) + fade out
      (function() {
        const loader = document.getElementById('loading-screen');
        if (!loader) return;

        // Start timer immediately after DOM is ready (not waiting for images)
        const start = () => {
          setTimeout(() => {
            loader.classList.add('is-hiding');
            // Remove after fade transition completes
            setTimeout(() => loader.remove(), 800);
          }, 5000);
        };

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', start);
        } else {
          start();
        }
      })();
</script>


  <script>
    // Gallery carousel + shared modal
    window.addEventListener('load', () => {
      const gallerySets = {
        'mm-look-1': [
          '/images/MM01.jpg',
          '/images/MM02.jpg',
          '/images/MM03.jpg',
          '/images/MM04.jpg'
        ],
        'fm-look-1': [
          '/images/FM01.jpg',
          '/images/FM02.jpg',
          '/images/FM03.jpg',
          '/images/FM04.jpg'
        ]
      };
      // Preload gallery images (throttled for mobile stability)
      (function preloadGalleryImages() {
        try {
          const urls = [];

          // Priority: carousel images first (for instant swipes)
          Object.values(gallerySets).forEach((arr) => {
            (arr || []).forEach((src) => { if (src) urls.push(src); });
          });

          // Then static images
          document.querySelectorAll('.static-gallery-image').forEach((img) => {
            const src = img.getAttribute('src');
            if (src) urls.push(src);
          });

          // De-dupe while preserving order
          const seen = new Set();
          const queue = urls.filter((u) => {
            if (seen.has(u)) return false;
            seen.add(u);
            return true;
          });

          // Limit concurrent downloads to avoid mobile Safari crashes
          const CONCURRENCY = 2;
          let active = 0;
          let i = 0;

          const loadNext = () => {
            while (active < CONCURRENCY && i < queue.length) {
              const src = queue[i++];
              active++;

              const img = new Image();
              img.decoding = 'async';
              img.loading = 'eager';

              const done = () => {
                active--;
                // Small stagger helps iOS stability
                setTimeout(loadNext, 60);
              };

              img.onload = done;
              img.onerror = done;
              img.src = src;

              if (img.decode) img.decode().then(done).catch(() => {});
            }
          };

          loadNext();
        } catch (e) {
          // preloading is an enhancement
        }
      })();

const modal = document.getElementById('imageModal');
      const modalImg = document.getElementById('modalImage');
      const closeBtn = modal.querySelector('.img-modal-close');
      const backdrop = modal.querySelector('.img-modal-backdrop');

      function openModal(src, alt) {
        modalImg.src = src;
        modalImg.alt = alt || '';
        modal.hidden = false;
        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        modal.hidden = true;
        modalImg.src = '';
        document.body.style.overflow = '';
      }

      if (closeBtn) closeBtn.addEventListener('click', closeModal);
      if (backdrop) backdrop.addEventListener('click', closeModal);
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !modal.hidden) closeModal();
      });

      Object.entries(gallerySets).forEach(([galleryId, images]) => {
        const wrapper = document.querySelector(`.gallery-carousel[data-gallery="${galleryId}"]`);
        if (!wrapper || !images || images.length === 0) return;

        const imgEl = wrapper.querySelector('.gallery-image');
        const prevBtn = wrapper.querySelector('.gallery-arrow.left');
        const nextBtn = wrapper.querySelector('.gallery-arrow.right');

        let currentIndex = 0;

        function showImage(idx) {
          const count = images.length;
          currentIndex = (idx + count) % count;
          imgEl.src = images[currentIndex];
        }

        showImage(0);

        if (prevBtn) prevBtn.addEventListener('click', () => showImage(currentIndex - 1));
        if (nextBtn) nextBtn.addEventListener('click', () => showImage(currentIndex + 1));

        // Touch swipe support (mobile only)
        const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints && navigator.maxTouchPoints > 0);
        if (isTouch) {
          let startX = 0;
          let startY = 0;
          let tracking = false;

          imgEl.addEventListener('touchstart', (e) => {
            const t = e.touches[0];
            if (!t) return;
            tracking = true;
            startX = t.clientX;
            startY = t.clientY;
          }, { passive: true });

          imgEl.addEventListener('touchend', (e) => {
            if (!tracking) return;
            tracking = false;
            const t = e.changedTouches[0];
            if (!t) return;

            const dx = t.clientX - startX;
            const dy = t.clientY - startY;

            // Ignore vertical scroll gestures
            if (Math.abs(dy) > Math.abs(dx)) return;

            const threshold = 40;
            if (dx <= -threshold) showImage(currentIndex + 1);
            else if (dx >= threshold) showImage(currentIndex - 1);
          }, { passive: true });
        }

        imgEl.addEventListener('click', () => openModal(imgEl.src, imgEl.alt));

      // Static images (non-carousel)
      document.querySelectorAll('.static-gallery-image').forEach((img) => {
        img.addEventListener('click', () => openModal(img.src, img.alt));
      });
      });
    });
  </script>

  

  <script defer src="/_vercel/insights/script.js"></script>
</body>
</html>
